<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007ba5; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #007ba5; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #007ba5; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>


  <!--radix_placeholder_meta_tags-->
  <title>Minicurso: Raspando os dados com R</title>

  <meta property="description" itemprop="description" content="Para facilitar nossa vida!"/>


  <!--  https://schema.org/Article -->
  <meta property="article:published" itemprop="datePublished" content="2021-12-24"/>
  <meta property="article:created" itemprop="dateCreated" content="2021-12-24"/>

  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="Minicurso: Raspando os dados com R"/>
  <meta property="og:type" content="article"/>
  <meta property="og:description" content="Para facilitar nossa vida!"/>
  <meta property="og:locale" content="en_US"/>
  <meta property="og:site_name" content="Minicurso"/>

  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary"/>
  <meta property="twitter:title" content="Minicurso: Raspando os dados com R"/>
  <meta property="twitter:description" content="Para facilitar nossa vida!"/>

  <!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->

  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","date","output"]}},"value":[{"type":"character","attributes":{},"value":["Raspando os dados com R"]},{"type":"character","attributes":{},"value":["Para facilitar nossa vida!\n"]},{"type":"character","attributes":{},"value":["2021-12-24"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["toc"]}},"value":[{"type":"logical","attributes":{},"value":[true]}]}]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  <!--radix_placeholder_navigation_in_header-->
  <meta name="distill:offset" content=""/>

  <script type="application/javascript">

    window.headroom_prevent_pin = false;

    window.document.addEventListener("DOMContentLoaded", function (event) {

      // initialize headroom for banner
      var header = $('header').get(0);
      var headerHeight = header.offsetHeight;
      var headroom = new Headroom(header, {
        tolerance: 5,
        onPin : function() {
          if (window.headroom_prevent_pin) {
            window.headroom_prevent_pin = false;
            headroom.unpin();
          }
        }
      });
      headroom.init();
      if(window.location.hash)
        headroom.unpin();
      $(header).addClass('headroom--transition');

      // offset scroll location for banner on hash change
      // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
      window.addEventListener("hashchange", function(event) {
        window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
      });

      // responsive menu
      $('.distill-site-header').each(function(i, val) {
        var topnav = $(this);
        var toggle = topnav.find('.nav-toggle');
        toggle.on('click', function() {
          topnav.toggleClass('responsive');
        });
      });

      // nav dropdowns
      $('.nav-dropbtn').click(function(e) {
        $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
        $(this).parent().siblings('.nav-dropdown')
           .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
      });
      $("body").click(function(e){
        $('.nav-dropdown-content').removeClass('nav-dropdown-active');
      });
      $(".nav-dropdown").click(function(e){
        e.stopPropagation();
      });
    });
  </script>

  <style type="text/css">

  /* Theme (user-documented overrideables for nav appearance) */

  .distill-site-nav {
    color: rgba(255, 255, 255, 0.8);
    background-color: #0F2E3D;
    font-size: 15px;
    font-weight: 300;
  }

  .distill-site-nav a {
    color: inherit;
    text-decoration: none;
  }

  .distill-site-nav a:hover {
    color: white;
  }

  @media print {
    .distill-site-nav {
      display: none;
    }
  }

  .distill-site-header {

  }

  .distill-site-footer {

  }


  /* Site Header */

  .distill-site-header {
    width: 100%;
    box-sizing: border-box;
    z-index: 3;
  }

  .distill-site-header .nav-left {
    display: inline-block;
    margin-left: 8px;
  }

  @media screen and (max-width: 768px) {
    .distill-site-header .nav-left {
      margin-left: 0;
    }
  }


  .distill-site-header .nav-right {
    float: right;
    margin-right: 8px;
  }

  .distill-site-header a,
  .distill-site-header .title {
    display: inline-block;
    text-align: center;
    padding: 14px 10px 14px 10px;
  }

  .distill-site-header .title {
    font-size: 18px;
    min-width: 150px;
  }

  .distill-site-header .logo {
    padding: 0;
  }

  .distill-site-header .logo img {
    display: none;
    max-height: 20px;
    width: auto;
    margin-bottom: -4px;
  }

  .distill-site-header .nav-image img {
    max-height: 18px;
    width: auto;
    display: inline-block;
    margin-bottom: -3px;
  }



  @media screen and (min-width: 1000px) {
    .distill-site-header .logo img {
      display: inline-block;
    }
    .distill-site-header .nav-left {
      margin-left: 20px;
    }
    .distill-site-header .nav-right {
      margin-right: 20px;
    }
    .distill-site-header .title {
      padding-left: 12px;
    }
  }


  .distill-site-header .nav-toggle {
    display: none;
  }

  .nav-dropdown {
    display: inline-block;
    position: relative;
  }

  .nav-dropdown .nav-dropbtn {
    border: none;
    outline: none;
    color: rgba(255, 255, 255, 0.8);
    padding: 16px 10px;
    background-color: transparent;
    font-family: inherit;
    font-size: inherit;
    font-weight: inherit;
    margin: 0;
    margin-top: 1px;
    z-index: 2;
  }

  .nav-dropdown-content {
    display: none;
    position: absolute;
    background-color: white;
    min-width: 200px;
    border: 1px solid rgba(0,0,0,0.15);
    border-radius: 4px;
    box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
    z-index: 1;
    margin-top: 2px;
    white-space: nowrap;
    padding-top: 4px;
    padding-bottom: 4px;
  }

  .nav-dropdown-content hr {
    margin-top: 4px;
    margin-bottom: 4px;
    border: none;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .nav-dropdown-active {
    display: block;
  }

  .nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
    color: black;
    padding: 6px 24px;
    text-decoration: none;
    display: block;
    text-align: left;
  }

  .nav-dropdown-content .nav-dropdown-header {
    display: block;
    padding: 5px 24px;
    padding-bottom: 0;
    text-transform: uppercase;
    font-size: 14px;
    color: #999999;
    white-space: nowrap;
  }

  .nav-dropdown:hover .nav-dropbtn {
    color: white;
  }

  .nav-dropdown-content a:hover {
    background-color: #ddd;
    color: black;
  }

  .nav-right .nav-dropdown-content {
    margin-left: -45%;
    right: 0;
  }

  @media screen and (max-width: 768px) {
    .distill-site-header a, .distill-site-header .nav-dropdown  {display: none;}
    .distill-site-header a.nav-toggle {
      float: right;
      display: block;
    }
    .distill-site-header .title {
      margin-left: 0;
    }
    .distill-site-header .nav-right {
      margin-right: 0;
    }
    .distill-site-header {
      overflow: hidden;
    }
    .nav-right .nav-dropdown-content {
      margin-left: 0;
    }
  }


  @media screen and (max-width: 768px) {
    .distill-site-header.responsive {position: relative; min-height: 500px; }
    .distill-site-header.responsive a.nav-toggle {
      position: absolute;
      right: 0;
      top: 0;
    }
    .distill-site-header.responsive a,
    .distill-site-header.responsive .nav-dropdown {
      display: block;
      text-align: left;
    }
    .distill-site-header.responsive .nav-left,
    .distill-site-header.responsive .nav-right {
      width: 100%;
    }
    .distill-site-header.responsive .nav-dropdown {float: none;}
    .distill-site-header.responsive .nav-dropdown-content {position: relative;}
    .distill-site-header.responsive .nav-dropdown .nav-dropbtn {
      display: block;
      width: 100%;
      text-align: left;
    }
  }

  /* Site Footer */

  .distill-site-footer {
    width: 100%;
    overflow: hidden;
    box-sizing: border-box;
    z-index: 3;
    margin-top: 30px;
    padding-top: 30px;
    padding-bottom: 30px;
    text-align: center;
  }

  /* Headroom */

  d-title {
    padding-top: 6rem;
  }

  @media print {
    d-title {
      padding-top: 4rem;
    }
  }

  .headroom {
    z-index: 1000;
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
  }

  .headroom--transition {
    transition: all .4s ease-in-out;
  }

  .headroom--unpinned {
    top: -100px;
  }

  .headroom--pinned {
    top: 0;
  }

  /* adjust viewport for navbar height */
  /* helps vertically center bootstrap (non-distill) content */
  .min-vh-100 {
    min-height: calc(100vh - 100px) !important;
  }

  </style>

  <script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet"/>
  <link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet"/>
  <script src="site_libs/headroom-0.9.4/headroom.min.js"></script>
  <script src="site_libs/autocomplete-0.37.1/autocomplete.min.js"></script>
  <script src="site_libs/fuse-6.4.1/fuse.min.js"></script>

  <script type="application/javascript">

  function getMeta(metaName) {
    var metas = document.getElementsByTagName('meta');
    for (let i = 0; i < metas.length; i++) {
      if (metas[i].getAttribute('name') === metaName) {
        return metas[i].getAttribute('content');
      }
    }
    return '';
  }

  function offsetURL(url) {
    var offset = getMeta('distill:offset');
    return offset ? offset + '/' + url : url;
  }

  function createFuseIndex() {

    // create fuse index
    var options = {
      keys: [
        { name: 'title', weight: 20 },
        { name: 'categories', weight: 15 },
        { name: 'description', weight: 10 },
        { name: 'contents', weight: 5 },
      ],
      ignoreLocation: true,
      threshold: 0
    };
    var fuse = new window.Fuse([], options);

    // fetch the main search.json
    return fetch(offsetURL('search.json'))
      .then(function(response) {
        if (response.status == 200) {
          return response.json().then(function(json) {
            // index main articles
            json.articles.forEach(function(article) {
              fuse.add(article);
            });
            // download collections and index their articles
            return Promise.all(json.collections.map(function(collection) {
              return fetch(offsetURL(collection)).then(function(response) {
                if (response.status === 200) {
                  return response.json().then(function(articles) {
                    articles.forEach(function(article) {
                      fuse.add(article);
                    });
                  })
                } else {
                  return Promise.reject(
                    new Error('Unexpected status from search index request: ' +
                              response.status)
                  );
                }
              });
            })).then(function() {
              return fuse;
            });
          });

        } else {
          return Promise.reject(
            new Error('Unexpected status from search index request: ' +
                        response.status)
          );
        }
      });
  }

  window.document.addEventListener("DOMContentLoaded", function (event) {

    // get search element (bail if we don't have one)
    var searchEl = window.document.getElementById('distill-search');
    if (!searchEl)
      return;

    createFuseIndex()
      .then(function(fuse) {

        // make search box visible
        searchEl.classList.remove('hidden');

        // initialize autocomplete
        var options = {
          autoselect: true,
          hint: false,
          minLength: 2,
        };
        window.autocomplete(searchEl, options, [{
          source: function(query, callback) {
            const searchOptions = {
              isCaseSensitive: false,
              shouldSort: true,
              minMatchCharLength: 2,
              limit: 10,
            };
            var results = fuse.search(query, searchOptions);
            callback(results
              .map(function(result) { return result.item; })
            );
          },
          templates: {
            suggestion: function(suggestion) {
              var img = suggestion.preview && Object.keys(suggestion.preview).length > 0
                ? `<img src="${offsetURL(suggestion.preview)}"</img>`
                : '';
              var html = `
                <div class="search-item">
                  <h3>${suggestion.title}</h3>
                  <div class="search-item-description">
                    ${suggestion.description || ''}
                  </div>
                  <div class="search-item-preview">
                    ${img}
                  </div>
                </div>
              `;
              return html;
            }
          }
        }]).on('autocomplete:selected', function(event, suggestion) {
          window.location.href = offsetURL(suggestion.path);
        });
        // remove inline display style on autocompleter (we want to
        // manage responsive display via css)
        $('.algolia-autocomplete').css("display", "");
      })
      .catch(function(error) {
        console.log(error);
      });

  });

  </script>

  <style type="text/css">

  .nav-search {
    font-size: x-small;
  }

  /* Algolioa Autocomplete */

  .algolia-autocomplete {
    display: inline-block;
    margin-left: 10px;
    vertical-align: sub;
    background-color: white;
    color: black;
    padding: 6px;
    padding-top: 8px;
    padding-bottom: 0;
    border-radius: 6px;
    border: 1px #0F2E3D solid;
    width: 180px;
  }


  @media screen and (max-width: 768px) {
    .distill-site-nav .algolia-autocomplete {
      display: none;
      visibility: hidden;
    }
    .distill-site-nav.responsive .algolia-autocomplete {
      display: inline-block;
      visibility: visible;
    }
    .distill-site-nav.responsive .algolia-autocomplete .aa-dropdown-menu {
      margin-left: 0;
      width: 400px;
      max-height: 400px;
    }
  }

  .algolia-autocomplete .aa-input, .algolia-autocomplete .aa-hint {
    width: 90%;
    outline: none;
    border: none;
  }

  .algolia-autocomplete .aa-hint {
    color: #999;
  }
  .algolia-autocomplete .aa-dropdown-menu {
    width: 550px;
    max-height: 70vh;
    overflow-x: visible;
    overflow-y: scroll;
    padding: 5px;
    margin-top: 3px;
    margin-left: -150px;
    background-color: #fff;
    border-radius: 5px;
    border: 1px solid #999;
    border-top: none;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion {
    cursor: pointer;
    padding: 5px 4px;
    border-bottom: 1px solid #eee;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion:last-of-type {
    border-bottom: none;
    margin-bottom: 2px;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item {
    overflow: hidden;
    font-size: 0.8em;
    line-height: 1.4em;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item h3 {
    font-size: 1rem;
    margin-block-start: 0;
    margin-block-end: 5px;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-description {
    display: inline-block;
    overflow: hidden;
    height: 2.8em;
    width: 80%;
    margin-right: 4%;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview {
    display: inline-block;
    width: 15%;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img {
    height: 3em;
    width: auto;
    display: none;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img[src] {
    display: initial;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion.aa-cursor {
    background-color: #eee;
  }
  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion em {
    font-weight: bold;
    font-style: normal;
  }

  </style>


  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

  <style type="text/css">

  body {
    background-color: white;
  }

  .pandoc-table {
    width: 100%;
  }

  .pandoc-table>caption {
    margin-bottom: 10px;
  }

  .pandoc-table th:not([align]) {
    text-align: left;
  }

  .pagedtable-footer {
    font-size: 15px;
  }

  d-byline .byline {
    grid-template-columns: 2fr 2fr;
  }

  d-byline .byline h3 {
    margin-block-start: 1.5em;
  }

  d-byline .byline .authors-affiliations h3 {
    margin-block-start: 0.5em;
  }

  .authors-affiliations .orcid-id {
    width: 16px;
    height:16px;
    margin-left: 4px;
    margin-right: 4px;
    vertical-align: middle;
    padding-bottom: 2px;
  }

  d-title .dt-tags {
    margin-top: 1em;
    grid-column: text;
  }

  .dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  d-article table.gt_table td,
  d-article table.gt_table th {
    border-bottom: none;
  }

  .html-widget {
    margin-bottom: 2.0em;
  }

  .l-screen-inset {
    padding-right: 16px;
  }

  .l-screen .caption {
    margin-left: 10px;
  }

  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .shaded-content {
    background: white;
  }

  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }

  .hidden {
    display: none !important;
  }

  d-article {
    padding-top: 2.5rem;
    padding-bottom: 30px;
  }

  d-appendix {
    padding-top: 30px;
  }

  d-article>p>img {
    width: 100%;
  }

  d-article h2 {
    margin: 1rem 0 1.5rem 0;
  }

  d-article h3 {
    margin-top: 1.5rem;
  }

  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }

  /* Tweak code blocks */

  d-article div.sourceCode code,
  d-article pre code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: auto;
  }

  d-article div.sourceCode {
    background-color: white;
  }

  d-article div.sourceCode pre {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }

  d-article pre {
    font-size: 12px;
    color: black;
    background: none;
    margin-top: 0;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  d-article pre a {
    border-bottom: none;
  }

  d-article pre a:hover {
    border-bottom: none;
    text-decoration: underline;
  }

  d-article details {
    grid-column: text;
    margin-bottom: 0.8em;
  }

  @media(min-width: 768px) {

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: visible !important;
  }

  d-article div.sourceCode pre {
    padding-left: 18px;
    font-size: 14px;
  }

  d-article pre {
    font-size: 14px;
  }

  }

  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  /* CSS for d-contents */

  .d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
  }

  @media(min-width: 1000px) {
    .d-contents.d-contents-float {
      height: 0;
      grid-column-start: 1;
      grid-column-end: 4;
      justify-self: center;
      padding-right: 3em;
      padding-left: 2em;
    }
  }

  .d-contents nav h3 {
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 1em;
  }

  .d-contents li {
    list-style-type: none
  }

  .d-contents nav > ul {
    padding-left: 0;
  }

  .d-contents ul {
    padding-left: 1em
  }

  .d-contents nav ul li {
    margin-top: 0.6em;
    margin-bottom: 0.2em;
  }

  .d-contents nav a {
    font-size: 13px;
    border-bottom: none;
    text-decoration: none
    color: rgba(0, 0, 0, 0.8);
  }

  .d-contents nav a:hover {
    text-decoration: underline solid rgba(0, 0, 0, 0.6)
  }

  .d-contents nav > ul > li > a {
    font-weight: 600;
  }

  .d-contents nav > ul > li > ul {
    font-weight: inherit;
  }

  .d-contents nav > ul > li > ul > li {
    margin-top: 0.2em;
  }


  .d-contents nav ul {
    margin-top: 0;
    margin-bottom: 0.25em;
  }

  .d-article-with-toc h2:nth-child(2) {
    margin-top: 0;
  }


  /* Figure */

  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }

  .figure img {
    width: 100%;
  }

  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }

  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }

  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }

  /* Citations */

  d-article .citation {
    color: inherit;
    cursor: inherit;
  }

  div.hanging-indent{
    margin-left: 1em; text-indent: -1em;
  }

  /* Citation hover box */

  .tippy-box[data-theme~=light-border] {
    background-color: rgba(250, 250, 250, 0.95);
  }

  .tippy-content > p {
    margin-bottom: 0;
    padding: 2px;
  }


  /* Tweak 1000px media break to show more text */

  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }

    .grid {
      grid-column-gap: 16px;
    }

    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }

  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }

    .grid {
      grid-column-gap: 32px;
    }
  }


  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */

  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  /* Include appendix styles here so they can be overridden */

  d-appendix {
    contain: layout style;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-top: 60px;
    margin-bottom: 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    color: rgba(0,0,0,0.5);
    padding-top: 60px;
    padding-bottom: 48px;
  }

  d-appendix h3 {
    grid-column: page-start / text-start;
    font-size: 15px;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.65);
  }

  d-appendix h3 + * {
    margin-top: 1em;
  }

  d-appendix ol {
    padding: 0 0 0 15px;
  }

  @media (min-width: 768px) {
    d-appendix ol {
      padding: 0 0 0 30px;
      margin-left: -30px;
    }
  }

  d-appendix li {
    margin-bottom: 1em;
  }

  d-appendix a {
    color: rgba(0, 0, 0, 0.6);
  }

  d-appendix > * {
    grid-column: text;
  }

  d-appendix > d-footnote-list,
  d-appendix > d-citation-list,
  d-appendix > distill-appendix {
    grid-column: screen;
  }

  /* Include footnote styles here so they can be overridden */

  d-footnote-list {
    contain: layout style;
  }

  d-footnote-list > * {
    grid-column: text;
  }

  d-footnote-list a.footnote-backlink {
    color: rgba(0,0,0,0.3);
    padding-left: 0.5em;
  }



  /* Anchor.js */

  .anchorjs-link {
    /*transition: all .25s linear; */
    text-decoration: none;
    border-bottom: none;
  }
  *:hover > .anchorjs-link {
    margin-left: -1.125em !important;
    text-decoration: none;
    border-bottom: none;
  }

  /* Social footer */

  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }

  .disqus-comments {
    margin-right: 30px;
  }

  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }

  #disqus_thread {
    margin-top: 30px;
  }

  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }

  .article-sharing a:hover {
    border-bottom: none;
  }

  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }

  .subscribe p {
    margin-bottom: 0.5em;
  }


  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }


  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }

  .custom p {
    margin-bottom: 0.5em;
  }

  /* Styles for listing layout (hide title) */
  .layout-listing d-title, .layout-listing .d-title {
    display: none;
  }

  /* Styles for posts lists (not auto-injected) */


  .posts-with-sidebar {
    padding-left: 45px;
    padding-right: 45px;
  }

  .posts-list .description h2,
  .posts-list .description p {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }

  .posts-list .description h2 {
    font-weight: 700;
    border-bottom: none;
    padding-bottom: 0;
  }

  .posts-list h2.post-tag {
    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
    padding-bottom: 12px;
  }
  .posts-list {
    margin-top: 60px;
    margin-bottom: 24px;
  }

  .posts-list .post-preview {
    text-decoration: none;
    overflow: hidden;
    display: block;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    padding: 24px 0;
  }

  .post-preview-last {
    border-bottom: none !important;
  }

  .posts-list .posts-list-caption {
    grid-column: screen;
    font-weight: 400;
  }

  .posts-list .post-preview h2 {
    margin: 0 0 6px 0;
    line-height: 1.2em;
    font-style: normal;
    font-size: 24px;
  }

  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.4em;
    font-size: 16px;
  }

  .posts-list .post-preview .thumbnail {
    box-sizing: border-box;
    margin-bottom: 24px;
    position: relative;
    max-width: 500px;
  }
  .posts-list .post-preview img {
    width: 100%;
    display: block;
  }

  .posts-list .metadata {
    font-size: 12px;
    line-height: 1.4em;
    margin-bottom: 18px;
  }

  .posts-list .metadata > * {
    display: inline-block;
  }

  .posts-list .metadata .publishedDate {
    margin-right: 2em;
  }

  .posts-list .metadata .dt-authors {
    display: block;
    margin-top: 0.3em;
    margin-right: 2em;
  }

  .posts-list .dt-tags {
    display: block;
    line-height: 1em;
  }

  .posts-list .dt-tags .dt-tag {
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0.3em 0.4em;
    margin-right: 0.2em;
    margin-bottom: 0.4em;
    font-size: 60%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  .posts-list img {
    opacity: 1;
  }

  .posts-list img[data-src] {
    opacity: 0;
  }

  .posts-more {
    clear: both;
  }


  .posts-sidebar {
    font-size: 16px;
  }

  .posts-sidebar h3 {
    font-size: 16px;
    margin-top: 0;
    margin-bottom: 0.5em;
    font-weight: 400;
    text-transform: uppercase;
  }

  .sidebar-section {
    margin-bottom: 30px;
  }

  .categories ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }

  .categories li {
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 0;
  }

  .categories li>a {
    border-bottom: none;
  }

  .categories li>a:hover {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  }

  .categories .active {
    font-weight: 600;
  }

  .categories .category-count {
    color: rgba(0, 0, 0, 0.4);
  }


  @media(min-width: 768px) {
    .posts-list .post-preview h2 {
      font-size: 26px;
    }
    .posts-list .post-preview .thumbnail {
      float: right;
      width: 30%;
      margin-bottom: 0;
    }
    .posts-list .post-preview .description {
      float: left;
      width: 45%;
    }
    .posts-list .post-preview .metadata {
      float: left;
      width: 20%;
      margin-top: 8px;
    }
    .posts-list .post-preview p {
      margin: 0 0 12px 0;
      line-height: 1.5em;
      font-size: 16px;
    }
    .posts-with-sidebar .posts-list {
      float: left;
      width: 75%;
    }
    .posts-with-sidebar .posts-sidebar {
      float: right;
      width: 20%;
      margin-top: 60px;
      padding-top: 24px;
      padding-bottom: 24px;
    }
  }


  /* Improve display for browsers without grid (IE/Edge <= 15) */

  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }

  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }

  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }

  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }

  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }

  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }

  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }


  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }

  .downlevel .footnotes ol {
    padding-left: 13px;
  }

  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }

  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }

  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }

  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  .downlevel .posts-list .post-preview {
    color: inherit;
  }



  </style>

  <script type="application/javascript">

  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }

  // show body when load is complete
  function on_load_complete() {

    // add anchors
    if (window.anchors) {
      window.anchors.options.placement = 'left';
      window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
    }


    // set body to visible
    document.body.style.visibility = 'visible';

    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }

    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }

  function init_distill() {

    init_common();

    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);

    // create d-title
    $('.d-title').changeElementType('d-title');

    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);

    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();

    // move posts container into article
    $('.posts-container').appendTo($('d-article'));

    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');

    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;

    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();

    // move refs into #references-listing
    $('#references-listing').replaceWith($('#refs'));

    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-contents a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });

    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');

    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {

      // capture layout
      var layout = $(this).attr('data-layout');

      // apply layout to markdown level block elements
      var elements = $(this).children().not('details, div.sourceCode, pre, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });


      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });

    // remove code block used to force  highlighting css
    $('.distill-force-highlighting-css').parent().remove();

    // remove empty line numbers inserted by pandoc when using a
    // custom syntax highlighting theme
    $('code.sourceCode a:empty').remove();

    // load distill framework
    load_distill_framework();

    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {

      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;

      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');

      // article with toc class
      $('.d-contents').parent().addClass('d-article-with-toc');

      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

      // add orcid ids
      $('.authors-affiliations').find('.author').each(function(i, el) {
        var orcid_id = front_matter.authors[i].orcidID;
        if (orcid_id) {
          var a = $('<a></a>');
          a.attr('href', 'https://orcid.org/' + orcid_id);
          var img = $('<img></img>');
          img.addClass('orcid-id');
          img.attr('alt', 'ORCID ID');
          img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
          a.append(img);
          $(this).append(a);
        }
      });

      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }

      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");

      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }

       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }

      // remove d-appendix and d-footnote-list local styles
      $('d-appendix > style:first-child').remove();
      $('d-footnote-list > style:first-child').remove();

      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();

      // hoverable references
      $('span.citation[data-cites]').each(function() {
        var refs = $(this).attr('data-cites').split(" ");
        var refHtml = refs.map(function(ref) {
          return "<p>" + $('#ref-' + ref).html() + "</p>";
        }).join("\n");
        window.tippy(this, {
          allowHTML: true,
          content: refHtml,
          maxWidth: 500,
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        });
      });

      // clear polling timer
      clearInterval(tid);

      // show body now that everything is ready
      on_load_complete();
    }

    var tid = setInterval(distill_post_process, 50);
    distill_post_process();

  }

  function init_downlevel() {

    init_common();

     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));

    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;

    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();

    // remove toc
    $('.d-contents').remove();

    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });


    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);

    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();

    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });

    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));

    $('body').addClass('downlevel');

    on_load_complete();
  }


  function init_common() {

    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};

        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });

        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);

    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});

    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });

      }
    });

    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });

    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace("index.html", "./"));
      });
    }

    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');

    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");

    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();

    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }

  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });

  </script>

  <!--/radix_placeholder_distill-->
  <script src="site_libs/header-attrs-2.11/header-attrs.js"></script>
  <link href="site_libs/panelset-0.2.6/panelset.css" rel="stylesheet" />
  <script src="site_libs/panelset-0.2.6/panelset.js"></script>
  <script src="site_libs/popper-2.6.0/popper.min.js"></script>
  <link href="site_libs/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="site_libs/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="site_libs/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="site_libs/anchor-4.2.2/anchor.min.js"></script>
  <script src="site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Raspando os dados com R","description":"Para facilitar nossa vida!","authors":[],"publishedDate":"2021-12-24T00:00:00.000-03:00"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="distill-site-nav distill-site-header">
<div class="nav-left">
<a class="logo">
<img src="img/icon_R.png" alt="Logo"/>
</a>
<a href="index.html" class="title">Minicurso</a>
<input id="distill-search" class="nav-search hidden" type="text" placeholder="Search..."/>
</div>
<div class="nav-right">
<a href="index.html">Home</a>
<a href="00_pre-requisitos.html">Pr-requisitos</a>
<div class="nav-dropdown">
<button class="nav-dropbtn">
Material Terico
 
<span class="down-arrow">&#x25BE;</span>
</button>
<div class="nav-dropdown-content">
<a href="01_web-scraping_panorama.html">O que  Webscraping?</a>
<a href="02_intro-html.html">Entendendo o html</a>
<a href="03_intro-R.html">Introduo ao R</a>
<a href="04_intro-tidyverse.html">Mais sobre o tidyverse</a>
<a href="05_raspagem.html">Raspando o que desejamos!</a>
</div>
</div>
<span class="nav-dropdown-header">Slides</span>
<a href="about.html">Sobre</a>
<a href="https://github.com/icaro-freire/site_webscraping">
<i class="fab fa-github" aria-hidden="true"></i>
</a>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Raspando os dados com R</h1>
<!--radix_placeholder_categories-->
<!--/radix_placeholder_categories-->
<p><p>Para facilitar nossa vida!</p></p>
</div>


<div class="d-article">
<div class="d-contents d-contents-float">
<nav class="l-text toc figcaption" id="TOC">
<h3>Contents</h3>
<ul>
<li><a href="#web-scraping-como-uma-ferramenta">5. Web Scraping como uma ferramenta</a>
<ul>
<li><a href="#tica-no-web-scraping">5.1 tica no Web Scraping</a></li>
<li><a href="#fazendo-download-de-vrios-arquivos">5.2 Fazendo download de vrios arquivos</a>
<ul>
<li><a href="#arquivos-de-texto">5.2.1 Arquivos de texto</a></li>
<li><a href="#arquivos-binrios">5.2.2 Arquivos binrios</a></li>
<li><a href="#raspando-tabelas">5.2.3 Raspando tabelas</a></li>
</ul></li>
<li><a href="#construindo-uma-tabela-para-tomada-de-deciso">5.3 Construindo uma tabela para tomada de deciso</a>
<ul>
<li><a href="#extraindo-os-nomes-dos-livros">5.3.1 Extraindo os nomes dos livros</a></li>
<li><a href="#extraindo-os-preos">5.3.2 Extraindo os preos</a></li>
<li><a href="#construindo-a-tabela">5.3.2 Construindo a tabela</a></li>
</ul></li>
<li><a href="#raspagem-com-vrias-pginas">5.4 Raspagem com vrias pginas</a></li>
</ul></li>
</ul>
</nav>
</div>
<h1 id="web-scraping-como-uma-ferramenta">5. Web Scraping como uma ferramenta</h1>
<p>Antes de iniciarmos nossos cdigos, nunca  demais salientar que esse texto trata-se de uma introduo. Coletar dados da <em>web</em> pode ser uma tarefa realmente rdua e desafiadora, pois os sites podem dificultar o acesso de diversas formas.</p>
<p>Abordaremos situaes simples, onde o web scraping realmente  usado como uma ferramenta para aumentar a produtividade do professor, reduzindo seu tempo em muitas situaes que frequentemente aparecem na vida profissional.</p>
<p>Uma outra coisa impotante, antes de iniciarmos a prtica,  sempre termos em mente que nossos cdigos so estabelecidos em certo momento temporal, ou seja, o cdigo funciona naquele momento e esperamos que continue assim.</p>
<p>Mas, sites podem mudar e, consequentemente, o nosso cdigo pode quebrar. Por isso, dependendo da poca em que voc esteja lendo esse texto, as coisas podem estar bem diferentes. A idia  voc entender os fundamentos e aplicar numa situao particular que deseja.</p>
<h2 id="tica-no-web-scraping">5.1 tica no Web Scraping</h2>
<p>Quando usamos um programa para extrair dados de um site, estamos fazendo requisies ao servidor daquele site. Obviamente, muitas requisies podem tornar lento um site e isso no  desejado por seus mantenedores.</p>
<p>Essa  uma das razes para que alguns sites <strong>restrinjam</strong> o acesso em determinada rea, ou da totalidade do site!</p>
<p>Por isso, conhecer as permisses de cada site  importantssimo numa possvel raspagem de dados.</p>
<blockquote>
<p>Sempre leia as permisses do site, antes de iniciar qualquer atividade de web scraping.</p>
</blockquote>
<p>Uma das formas de sabermos se um site permite a raspagem  verificando os <strong>robots.txt</strong>.</p>
<p>Para isso, na url de cada site, ao final da mesma, digite: /robots.txt.</p>
<p>Essa  uma condio necessria, mas no suficiente. Alguns sites colocam restries no nos robots.txt, mas em alguma seo do mesmo. Por isso, se no aparecer nada no texto do robots.txt, pode ser que o site no o tenha. Ento, deve-se procurar informaes sobre raspagem de dados no prprio site!</p>
<p>Por exemplo, no site da ANPMat (Associao Nacional dos Professores de Matemtica na Educao Bsica), a saber:</p>
<p align="center">
<a src='https://anpmat.org.br/'> https://anpmat.org.br/ </a>
</p>
<p>Podemos verificar se robs podem acess-lo. Para isso, digitamos:</p>
<p align="center">
<a src='https://anpmat.org.br/robots.txt'> https://anpmat.org.br/robots.txt </a>
</p>
<p>A seguinte mensagem aparece:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># XML Sitemap &amp; Google News version 5.2.7 - https://status301.net/wordpress-plugins/xml-sitemap-feed/</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>Sitemap<span class="sc">:</span> https<span class="sc">:</span><span class="er">//</span>anpmat.org.br<span class="sc">/</span>sitemap.xml</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>User<span class="sc">-</span>agent<span class="sc">:</span> <span class="er">*</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>Disallow<span class="sc">:</span> <span class="er">/</span>wp<span class="sc">-</span>admin<span class="sc">/</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>Allow<span class="sc">:</span> <span class="er">/</span>wp<span class="sc">-</span>admin<span class="sc">/</span>admin<span class="sc">-</span>ajax.php</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>Sitemap<span class="sc">:</span> https<span class="sc">:</span><span class="er">//</span>anpmat.org.br<span class="sc">/</span>wp<span class="sc">-</span>sitemap.xml</span></code></pre></div>
</div>
<p>Veja que a seo wp-admin no est hailitada para web scraping.</p>
<p>Uma outra questo,  quando envolve a raspagem de dados em muitas pginas. Mas, o pacote <a href="https://dmi3kno.github.io/polite/">polite</a> pode ser usado junto com o <code>rvest</code> e solucionar esse problema, visto que esse pacote respeitar as requisies feitas em cada site.</p>
<p>Bom  agora vamos  prtica!</p>
<h2 id="fazendo-download-de-vrios-arquivos">5.2 Fazendo download de vrios arquivos</h2>
<p>Uma das situaes que comumente nos deparamos em nossa profisso  fazermos downloads de bons materiais disponveis gratuitamente na internet. Porm, se a lista de download for relativamente grande, fazer isso manualmente, ou seja, clicar em cada um deles e salvar num determinado local  pode ser tedioso.</p>
<p>Mas  graas a Deus, exite o R!</p>
<h3 id="arquivos-de-texto">5.2.1 Arquivos de texto</h3>
<p>Para exemplificar o <em>dowload</em> de vrios arquivos de texto, vamos acessar o link da pgina do <em>Laboratrio de Estatstica Computacional  LEC</em>, da UESC. Na seo Material Didtico/R, esto disponveis <em>scripts</em>, em R, sobre diversos temas, dentre outras coisas.</p>
<blockquote>
<p><strong>O que desejamos fazer?</strong> . Essa pergunta sempre deve ser nosso norte, antes de iniciarmos a raspagem dos dados!</p>
</blockquote>
<p>Nosso objetivo, nesse exemplo,  fazer o <em>download</em> dos 18 arquivos que se encontram na seo Introduo ao R (tutor: prof. Jos Cludio Faria), etiquetados como: CIR.00_apresentao, CIR.01_gerenciamentos_pacotes, , CIR.17aplicaes. Como na figura abaixo:</p>
<div class="layout-chunk" data-layout="l-body">
<p><img src="img/uesc-pro_seta.png" width="824" style="display: block; margin: auto;" /></p>
</div>
<p>Agora, vamos atribuir  varivel <strong>url_uesc</strong> o link da url em questo:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>url_uesc</span> <span class='op'>&lt;-</span> <span class='st'>"https://lec.pro.br/avale-es/r"</span>
</code></pre>
</div>
</div>
<p>E,  varivel <strong>site_uesc</strong> o html extrado com a funo <code>read_html()</code>, do pacote <code>rvest</code>:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>site_uesc</span> <span class='op'>&lt;-</span> <span class='fu'>rvest</span><span class='fu'>::</span><span class='fu'><a href='http://xml2.r-lib.org/reference/read_xml.html'>read_html</a></span><span class='op'>(</span><span class='va'>url_uesc</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Estamos prontos para a manipulao desses dados!</p>
<p>Com a ajuda do <em>SelectorGadget</em>, selecionamos o elemento que desejamos raspar e, depois, fazemos os ajustes necessrios (at ficar em amarelo o que desejamos, da menor forma possvel).</p>
<p>Abaixo, o cdigo mostra que o elemento CCS li:nth-child(2) h5+ ul a</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>site_uesc</span> |&gt; 
  <span class='fu'>rvest</span><span class='fu'>::</span><span class='fu'><a href='https://rvest.tidyverse.org/reference/html_element.html'>html_elements</a></span><span class='op'>(</span><span class='st'>"li:nth-child(2) h5+ ul a"</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>{xml_nodeset (18)}
 [1] &lt;a href=&quot;/download/R/cir/CIR.00_apresentacao.R&quot;&gt;CIR.00_apresen ...
 [2] &lt;a href=&quot;/download/R/cir/CIR.01_gerenciamento_pacotes.R&quot;&gt;CIR.0 ...
 [3] &lt;a href=&quot;/download/R/cir/CIR.02_documentacao_ajuda.R&quot;&gt;CIR.02_d ...
 [4] &lt;a href=&quot;/download/R/cir/CIR.03_operadores.R&quot;&gt;CIR.03_operadore ...
 [5] &lt;a href=&quot;/download/R/cir/CIR.04_funcoes_elementares.R&quot;&gt;CIR.04_ ...
 [6] &lt;a href=&quot;/download/R/cir/CIR.05_vetores.R&quot;&gt;CIR.05_vetores&lt;/a&gt;
 [7] &lt;a href=&quot;/download/R/cir/CIR.06_matrizes.R&quot;&gt;CIR.06_matrizes&lt;/a&gt;
 [8] &lt;a href=&quot;/download/R/cir/CIR.07_dataframes.R&quot;&gt;CIR.07_dataframe ...
 [9] &lt;a href=&quot;/download/R/cir/CIR.08_arrays.R&quot;&gt;CIR.08_arrays&lt;/a&gt;
[10] &lt;a href=&quot;/download/R/cir/CIR.09_listas.R&quot;&gt;CIR.09_listas&lt;/a&gt;
[11] &lt;a href=&quot;/download/R/cir/CIR.10_tabelas.R&quot;&gt;CIR.10_tabelas&lt;/a&gt;
[12] &lt;a href=&quot;/download/R/cir/CIR.11_condicionais_loops.R&quot;&gt;CIR.11_c ...
[13] &lt;a href=&quot;/download/R/cir/CIR.12_funcoes_muito_usadas.R&quot;&gt;CIR.12 ...
[14] &lt;a href=&quot;/download/R/cir/CIR.13_funcoes_construindo.R&quot;&gt;CIR.13_ ...
[15] &lt;a href=&quot;/download/R/cir/CIR.14_calculo.R&quot;&gt;CIR.14_clculo&lt;/a&gt;
[16] &lt;a href=&quot;/download/R/cir/CIR.15_importando_exportando.R&quot;&gt;CIR.1 ...
[17] &lt;a href=&quot;/download/R/cir/CIR.16_graficos.R&quot;&gt;CIR.16_grficos&lt;/a&gt;
[18] &lt;a href=&quot;/download/R/cir/CIR.17_aplicacoes.R&quot;&gt;CIR.17_aplicae ...</code></pre>
</div>
<p>Obviamemte o elemento CCS pode mudar um pouco. Dependender muito da seleo que voc fez. Por exemplo, se no fossem feitos os ajustes, a <em>tag</em> a serviria normalmente. O problema dessa abordadem  que existem muitas outras <em>tags</em> a espalhadas pelo site que no nos interessa.</p>
<p>Feito isso, precisamos extrair desses elementos os <em>links</em> de cada arquivo. O atributto href nos dar isso. Ento, basta usarmos a funo <code>rvest::html_attr("href")</code>:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>site_uesc</span> |&gt; 
  <span class='fu'>rvest</span><span class='fu'>::</span><span class='fu'><a href='https://rvest.tidyverse.org/reference/html_element.html'>html_elements</a></span><span class='op'>(</span><span class='st'>"li:nth-child(2) h5+ ul a"</span><span class='op'>)</span> |&gt; 
  <span class='fu'>rvest</span><span class='fu'>::</span><span class='fu'><a href='https://rvest.tidyverse.org/reference/html_attr.html'>html_attr</a></span><span class='op'>(</span><span class='st'>"href"</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code> [1] &quot;/download/R/cir/CIR.00_apresentacao.R&quot;         
 [2] &quot;/download/R/cir/CIR.01_gerenciamento_pacotes.R&quot;
 [3] &quot;/download/R/cir/CIR.02_documentacao_ajuda.R&quot;   
 [4] &quot;/download/R/cir/CIR.03_operadores.R&quot;           
 [5] &quot;/download/R/cir/CIR.04_funcoes_elementares.R&quot;  
 [6] &quot;/download/R/cir/CIR.05_vetores.R&quot;              
 [7] &quot;/download/R/cir/CIR.06_matrizes.R&quot;             
 [8] &quot;/download/R/cir/CIR.07_dataframes.R&quot;           
 [9] &quot;/download/R/cir/CIR.08_arrays.R&quot;               
[10] &quot;/download/R/cir/CIR.09_listas.R&quot;               
[11] &quot;/download/R/cir/CIR.10_tabelas.R&quot;              
[12] &quot;/download/R/cir/CIR.11_condicionais_loops.R&quot;   
[13] &quot;/download/R/cir/CIR.12_funcoes_muito_usadas.R&quot; 
[14] &quot;/download/R/cir/CIR.13_funcoes_construindo.R&quot;  
[15] &quot;/download/R/cir/CIR.14_calculo.R&quot;              
[16] &quot;/download/R/cir/CIR.15_importando_exportando.R&quot;
[17] &quot;/download/R/cir/CIR.16_graficos.R&quot;             
[18] &quot;/download/R/cir/CIR.17_aplicacoes.R&quot;           </code></pre>
</div>
<p>Antes de prosseguirmos note um certo padro que aparece nos links desejados. Por exemplo, antes do nome dos arquivos que desejamos extrair, podemos observar a repetio dos caracteres <strong>CIR.</strong>. Isso seria importante se a nossa seleo abrangesse mais arquivos alm do exposto. Se isso ocorresse, poderamos usar uma funo do pacote <code>stringr</code> para selecionarmos esse padro especfico: <strong>stringr::str_subset(CIR.)</strong>. Mas, como a nossa seleo foi bem exitosa, afinal extraiu o que desejvamos, no usaremos essa funo em nosso <em>script</em>.</p>
<p>Nesso momento, tambm  importante notar que, se clicarmos diretamente em algum dos links desejados, aparecer uma parte da <em>url</em>, a saber, <a href="https://lec.pro.br" class="uri">https://lec.pro.br</a>, que no se encontra no conjunto acima listado.</p>
<p>Para inserirmos essa parte da url, ANTES dos itens da lista acima, usaremos a funo <strong>str_c()</strong>, do pacote <code>stringr</code>. Veja o cdigo abaixo (note que usamos o pipe <code>%&gt;%</code>, pois passaremos o argumento anterior na SEGUNDA posio):</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>site_uesc</span> |&gt; 
  <span class='fu'>rvest</span><span class='fu'>::</span><span class='fu'><a href='https://rvest.tidyverse.org/reference/html_element.html'>html_elements</a></span><span class='op'>(</span><span class='st'>"li:nth-child(2) h5+ ul a"</span><span class='op'>)</span> |&gt; 
  <span class='fu'>rvest</span><span class='fu'>::</span><span class='fu'><a href='https://rvest.tidyverse.org/reference/html_attr.html'>html_attr</a></span><span class='op'>(</span><span class='st'>"href"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'>stringr</span><span class='fu'>::</span><span class='fu'><a href='https://stringr.tidyverse.org/reference/str_c.html'>str_c</a></span><span class='op'>(</span><span class='st'>"https://lec.pro.br"</span>, <span class='va'>.</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code> [1] &quot;https://lec.pro.br/download/R/cir/CIR.00_apresentacao.R&quot;         
 [2] &quot;https://lec.pro.br/download/R/cir/CIR.01_gerenciamento_pacotes.R&quot;
 [3] &quot;https://lec.pro.br/download/R/cir/CIR.02_documentacao_ajuda.R&quot;   
 [4] &quot;https://lec.pro.br/download/R/cir/CIR.03_operadores.R&quot;           
 [5] &quot;https://lec.pro.br/download/R/cir/CIR.04_funcoes_elementares.R&quot;  
 [6] &quot;https://lec.pro.br/download/R/cir/CIR.05_vetores.R&quot;              
 [7] &quot;https://lec.pro.br/download/R/cir/CIR.06_matrizes.R&quot;             
 [8] &quot;https://lec.pro.br/download/R/cir/CIR.07_dataframes.R&quot;           
 [9] &quot;https://lec.pro.br/download/R/cir/CIR.08_arrays.R&quot;               
[10] &quot;https://lec.pro.br/download/R/cir/CIR.09_listas.R&quot;               
[11] &quot;https://lec.pro.br/download/R/cir/CIR.10_tabelas.R&quot;              
[12] &quot;https://lec.pro.br/download/R/cir/CIR.11_condicionais_loops.R&quot;   
[13] &quot;https://lec.pro.br/download/R/cir/CIR.12_funcoes_muito_usadas.R&quot; 
[14] &quot;https://lec.pro.br/download/R/cir/CIR.13_funcoes_construindo.R&quot;  
[15] &quot;https://lec.pro.br/download/R/cir/CIR.14_calculo.R&quot;              
[16] &quot;https://lec.pro.br/download/R/cir/CIR.15_importando_exportando.R&quot;
[17] &quot;https://lec.pro.br/download/R/cir/CIR.16_graficos.R&quot;             
[18] &quot;https://lec.pro.br/download/R/cir/CIR.17_aplicacoes.R&quot;           </code></pre>
</div>
<p>O que precisamos, agora,  fazer o <em>download</em>. Antes, porm, vamos salvar na varivel <strong>links_uesc</strong> a lista extrada acima.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>links_uesc</span> <span class='op'>&lt;-</span> <span class='va'>site_uesc</span> |&gt; 
  <span class='fu'>rvest</span><span class='fu'>::</span><span class='fu'><a href='https://rvest.tidyverse.org/reference/html_element.html'>html_elements</a></span><span class='op'>(</span><span class='st'>"li:nth-child(2) h5+ ul a"</span><span class='op'>)</span> |&gt; 
  <span class='fu'>rvest</span><span class='fu'>::</span><span class='fu'><a href='https://rvest.tidyverse.org/reference/html_attr.html'>html_attr</a></span><span class='op'>(</span><span class='st'>"href"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'>stringr</span><span class='fu'>::</span><span class='fu'><a href='https://stringr.tidyverse.org/reference/str_c.html'>str_c</a></span><span class='op'>(</span><span class='st'>"https://lec.pro.br"</span>, <span class='va'>.</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Estamos quase prontos para fazerrmos o <em>download</em> dos arquivos. Entretanto, vamos organizar as coisas </p>
<p>Por exemplo, quando fizermos o <em>download</em>, qual ser o nome dos arquivos? Poderamos criar uma lista com o nome que desejarmos, mas, por hora, vamos deixar os nomes que j esto no final de cada link, pois possui certo padro:</p>
<ul>
<li><code>CIR.n_nome-do-arquivo.R</code>, onde <span class="math inline">\(n\)</span> varia de 00 at 17.</li>
</ul>
<p>Mas, como extrair esses nomes?</p>
<p>Para responder essa pergunta, vamos usar um pacote chamado <code>fs</code> (<em>file system</em>). Ele possui uma funo denominada <strong>path_file()</strong>, que faz justamente o que precisamos. Podemos, ento, salvar numa varivel <strong>nomes_links_uesc</strong> tais nomes:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>nomes_links_uesc</span> <span class='op'>&lt;-</span> <span class='fu'>fs</span><span class='fu'>::</span><span class='fu'><a href='https://fs.r-lib.org/reference/path_file.html'>path_file</a></span><span class='op'>(</span><span class='va'>links_uesc</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Vimos que a funo <code>download.file()</code> precisa de dois argumentos para fazer o <em>download</em> de um arquivo de texto plano: o <em>link</em> e o caminho para salvar o arquivo. J temos o <em>link</em> e, para no fazermos manualmente a criao de diretrios para salvar os arquivos, vamos usar uma outra funo do pacote <code>fs</code>: <strong>dir_create()</strong>. Nela vamos escrever o caminho onde queremos salvar os arquivos, juntamente com a lista dos nomes.</p>
<p>Como, nesse minicurso, faremos download de vrios arquivos, vamos criar um diretrio mais geral, denominado <strong>download_arquivos/</strong>, onde sero salvos os arquivos dos sites especficos estudados.</p>
<p>Por exemplo, para os arquivos desse site da UESC, criaremos um subdiretrio por nome arquivos_uesc/. Vamos atribuir  varivel <strong>arquivos_uesc</strong> todo esse procedimento (note que o nome da varivel  o mesmo nome da pasta onde salvaremos os arquivos desse site). O cdigo fica assim:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>arquivos_uesc</span> <span class='op'>&lt;-</span> <span class='fu'>fs</span><span class='fu'>::</span><span class='fu'><a href='https://fs.r-lib.org/reference/create.html'>dir_create</a></span><span class='op'>(</span><span class='st'>"download_arquivos/arquivos_uesc"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Por fim, vamos iterar o download para todos os 18 arquivos, usando o pacote <code>purrr</code>, por meio da funo <strong>walk2()</strong>:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>purrr</span><span class='fu'>::</span><span class='fu'><a href='https://purrr.tidyverse.org/reference/map2.html'>walk2</a></span><span class='op'>(</span><span class='va'>links_uesc</span>, <span class='va'>arquivos_uesc</span><span class='op'>/</span><span class='va'>nomes_links_uesc</span>, <span class='va'>download.file</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Maravilha, no?</p>
<p>Voc pode conferir o <em>script</em> completo abaixo:</p>
<details>
<summary>
Script para download dos arquivos, em R, disponveis no site da UESC
</summary>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#==============================================================================</span>
<span class='co'># Raspando material sobre R</span>
<span class='co'># caro Vidal Freire</span>
<span class='co'># data de acesso: 2021-12-19</span>
<span class='co'>#==============================================================================</span>

<span class='co'># pacote usado ------------------------------------------------------------</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://magrittr.tidyverse.org'>magrittr</a></span><span class='op'>)</span>

<span class='co'># url do site -------------------------------------------------------------</span>
<span class='va'>url_uesc</span> <span class='op'>&lt;-</span> <span class='st'>"https://lec.pro.br/avale-es/r"</span>

<span class='co'># site para scraping ------------------------------------------------------</span>
<span class='va'>site_uesc</span> <span class='op'>&lt;-</span> <span class='fu'>rvest</span><span class='fu'>::</span><span class='fu'><a href='http://xml2.r-lib.org/reference/read_xml.html'>read_html</a></span><span class='op'>(</span><span class='va'>url_uesc</span><span class='op'>)</span>

<span class='co'># raspando os materiais ---------------------------------------------------</span>
<span class='va'>links_uesc</span> <span class='op'>&lt;-</span> <span class='va'>site_uesc</span> |&gt; 
  <span class='fu'>rvest</span><span class='fu'>::</span><span class='fu'><a href='https://rvest.tidyverse.org/reference/html_element.html'>html_elements</a></span><span class='op'>(</span><span class='st'>"li:nth-child(2) h5+ ul a"</span><span class='op'>)</span> |&gt; 
  <span class='fu'>rvest</span><span class='fu'>::</span><span class='fu'><a href='https://rvest.tidyverse.org/reference/html_attr.html'>html_attr</a></span><span class='op'>(</span><span class='st'>"href"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'>stringr</span><span class='fu'>::</span><span class='fu'><a href='https://stringr.tidyverse.org/reference/str_c.html'>str_c</a></span><span class='op'>(</span><span class='st'>"https://lec.pro.br"</span>, <span class='va'>.</span><span class='op'>)</span>

<span class='co'># preparando para download ------------------------------------------------</span>
<span class='va'>arquivos_uesc</span> <span class='op'>&lt;-</span> <span class='fu'>fs</span><span class='fu'>::</span><span class='fu'><a href='https://fs.r-lib.org/reference/create.html'>dir_create</a></span><span class='op'>(</span><span class='st'>"download_arquivos/arquivos_uesc"</span><span class='op'>)</span>
<span class='va'>nomes_links_uesc</span> <span class='op'>&lt;-</span> <span class='fu'>fs</span><span class='fu'>::</span><span class='fu'><a href='https://fs.r-lib.org/reference/path_file.html'>path_file</a></span><span class='op'>(</span><span class='va'>links_uesc</span><span class='op'>)</span>

<span class='co'># fazendo o download ------------------------------------------------------</span>
<span class='fu'>purrr</span><span class='fu'>::</span><span class='fu'><a href='https://purrr.tidyverse.org/reference/map2.html'>walk2</a></span><span class='op'>(</span><span class='va'>links_uesc</span>, <span class='va'>arquivos_uesc</span><span class='op'>/</span><span class='va'>nomes_links_uesc</span>, <span class='va'>download.file</span><span class='op'>)</span>

<span class='co'>#==============================================================================</span>
</code></pre>
</div>
</div>
</details>
<h3 id="arquivos-binrios">5.2.2 Arquivos binrios</h3>
<p>Nessa seo, vamos fazer o download de arquivos binrios no formato <code>pdf</code>. O site onde se encontram esses arquivos  o da <em>Olimpada Brasileira de Matemtica</em> (OBM), especificamente na rea da Revista Eureka:</p>
<p align="center">
<a href='https://www.obm.org.br/revista-eureka/'> https://www.obm.org.br/revista-eureka/ </a>
</p>
<p>Nosso objetivo  fazer o download das 42 revistas, no formato <code>pdf</code>, e organizar esses arquivos com nomes seguindo determinado padro.</p>
<p>O primeiro passo  fazer a leitura do site. Antes, porm, vamos atribir  varivel <code>url_eureka</code> o link do site:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>url_eureka</span> <span class='op'>&lt;-</span> <span class='st'>"https://www.obm.org.br/revista-eureka/"</span>
</code></pre>
</div>
</div>
<p>Prosseguimos, ento, com a leitura, atribuindo  varivel <code>site_eureka</code> seu resultado:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>site_eureka</span> <span class='op'>&lt;-</span> <span class='fu'>rvest</span><span class='fu'>::</span><span class='fu'><a href='http://xml2.r-lib.org/reference/read_xml.html'>read_html</a></span><span class='op'>(</span><span class='va'>url_eureka</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Feito isso, precisamos dos elementos que contm os links que desejamos para download. A seleo do CSS ajuda-nos a delimitar as opes adequadamente.</p>
<p>Entretanto, nesse ponto, perceba uma sutil diferena ao clicar sobre a imagem de algum arquivo do pdf e num pequeno espao, ao seu lado. Para ser mais claro, vamos considerar o link associado  Revista n 42:</p>
<div class="layout-chunk" data-layout="l-body">
<p><img src="img/div_a-img.png" width="1170" /></p>
</div>
<p>Obviamente, o link que ser extrado no se encontra na <em>tag</em> de img. Portanto, devemos clicar num pequeno espao ao lado dessa imagem de pdf e depois fazermos os ajustes, clicando novamente nos itens que no nos interessa no momento, como por exemplo, nos links do cabealho da pgina.</p>
<p>Com o passo acima, um elemento CSS possvel seria: #revistas-list a. Logo, podemos extrair os links assim:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>site_eureka</span> |&gt; 
  <span class='fu'>rvest</span><span class='fu'>::</span><span class='fu'><a href='https://rvest.tidyverse.org/reference/html_element.html'>html_elements</a></span><span class='op'>(</span><span class='st'>"#revistas-list a"</span><span class='op'>)</span> |&gt; 
  <span class='fu'>rvest</span><span class='fu'>::</span><span class='fu'><a href='https://rvest.tidyverse.org/reference/html_attr.html'>html_attr</a></span><span class='op'>(</span><span class='st'>"href"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code> [1] &quot;https://www.obm.org.br/content/uploads/2021/11/Eureka_42.pdf&quot;        
 [2] &quot;https://www.obm.org.br/content/uploads/2021/11/revista_eureka_41.pdf&quot;
 [3] &quot;https://www.obm.org.br/content/uploads/2017/02/Eureka40.pdf&quot;         
 [4] &quot;https://www.obm.org.br/content/uploads/2017/01/eureka39.pdf&quot;         
 [5] &quot;https://www.obm.org.br/content/uploads/2017/01/eureka38.pdf&quot;         
 [6] &quot;https://www.obm.org.br/content/uploads/2017/01/eureka37.doc&quot;         
 [7] &quot;https://www.obm.org.br/content/uploads/2017/01/eureka37.pdf&quot;         
 [8] &quot;https://www.obm.org.br/content/uploads/2017/01/eureka36.doc&quot;         
 [9] &quot;https://www.obm.org.br/content/uploads/2017/01/eureka36.pdf&quot;         
[10] &quot;https://www.obm.org.br/content/uploads/2017/01/Eureka35.doc&quot;         </code></pre>
</div>
<p>Mas, para selecionarmos apenas o formato pdf, usamos: <code>stringr::str_subset(".pdf")</code>. Vamos atribuir  varivel <code>links_eureka</code> esses procedimentos:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>links_eureka</span> <span class='op'>&lt;-</span> <span class='va'>site_eureka</span> |&gt; 
  <span class='fu'>rvest</span><span class='fu'>::</span><span class='fu'><a href='https://rvest.tidyverse.org/reference/html_element.html'>html_elements</a></span><span class='op'>(</span><span class='st'>"#revistas-list a"</span><span class='op'>)</span> |&gt; 
  <span class='fu'>rvest</span><span class='fu'>::</span><span class='fu'><a href='https://rvest.tidyverse.org/reference/html_attr.html'>html_attr</a></span><span class='op'>(</span><span class='st'>"href"</span><span class='op'>)</span> |&gt; 
  <span class='fu'>stringr</span><span class='fu'>::</span><span class='fu'><a href='https://stringr.tidyverse.org/reference/str_subset.html'>str_subset</a></span><span class='op'>(</span><span class='st'>".pdf"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Se visualizarmos os nomes desses links, notaremos que no h um padro nico. Para contornar isso, vamos criar uma lista com 42 nomes com o seguinte padro:</p>
<ul>
<li><code>n_eureka</code>; onde <span class="math inline">\(n\)</span>  um nmero que varia de 1 a 42.</li>
</ul>
<p>Uma maneira de criar essa sequncia de nmeros  usarmos a funo <code>seq()</code>, do R Base:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>42</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code> [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22
[23] 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42</code></pre>
</div>
<p>Mas, vamos estabelecer que nosso padro contenha sempre dois dgitos. Ento, para os algarsmos de 1 at 9, colocaremos o nmero 0 (zero)  esquerda deles. Dessa forma, basta aglutinarmos o caractere 0  sequncia <code>seq(1, 9)</code>. A funo <code>str_c()</code>, do pacote <strong>stringr</strong>,  adequada para isso:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>stringr</span><span class='fu'>::</span><span class='fu'><a href='https://stringr.tidyverse.org/reference/str_c.html'>str_c</a></span><span class='op'>(</span><span class='st'>"0"</span>, <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>9</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] &quot;01&quot; &quot;02&quot; &quot;03&quot; &quot;04&quot; &quot;05&quot; &quot;06&quot; &quot;07&quot; &quot;08&quot; &quot;09&quot;</code></pre>
</div>
<p>Todavia, vamos concatenar esse resultado com os nmeros restantes (de 10 a 42), atribuindo  varivel <code>index</code> (pois  uma indexao) esse procedimento:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>index</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'>stringr</span><span class='fu'>::</span><span class='fu'><a href='https://stringr.tidyverse.org/reference/str_c.html'>str_c</a></span><span class='op'>(</span><span class='st'>"0"</span>, <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>9</span><span class='op'>)</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>10</span>, <span class='fl'>42</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Portanto, para criarmos a lista com 42 nomes padronizados, vamos aglutinar  indexao o pado _eureka, atribuindo  varivel <code>nomes_eureka</code> esses procedimentos:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>nomes_eureka</span> <span class='op'>&lt;-</span> <span class='fu'>stringr</span><span class='fu'>::</span><span class='fu'><a href='https://stringr.tidyverse.org/reference/str_c.html'>str_c</a></span><span class='op'>(</span><span class='va'>index</span>, <span class='st'>"_eureka"</span><span class='op'>)</span>

<span class='va'>nomes_eureka</span>
</code></pre>
</div>
<pre><code> [1] &quot;01_eureka&quot; &quot;02_eureka&quot; &quot;03_eureka&quot; &quot;04_eureka&quot; &quot;05_eureka&quot;
 [6] &quot;06_eureka&quot; &quot;07_eureka&quot; &quot;08_eureka&quot; &quot;09_eureka&quot; &quot;10_eureka&quot;
[11] &quot;11_eureka&quot; &quot;12_eureka&quot; &quot;13_eureka&quot; &quot;14_eureka&quot; &quot;15_eureka&quot;
[16] &quot;16_eureka&quot; &quot;17_eureka&quot; &quot;18_eureka&quot; &quot;19_eureka&quot; &quot;20_eureka&quot;
[21] &quot;21_eureka&quot; &quot;22_eureka&quot; &quot;23_eureka&quot; &quot;24_eureka&quot; &quot;25_eureka&quot;
[26] &quot;26_eureka&quot; &quot;27_eureka&quot; &quot;28_eureka&quot; &quot;29_eureka&quot; &quot;30_eureka&quot;
[31] &quot;31_eureka&quot; &quot;32_eureka&quot; &quot;33_eureka&quot; &quot;34_eureka&quot; &quot;35_eureka&quot;
[36] &quot;36_eureka&quot; &quot;37_eureka&quot; &quot;38_eureka&quot; &quot;39_eureka&quot; &quot;40_eureka&quot;
[41] &quot;41_eureka&quot; &quot;42_eureka&quot;</code></pre>
</div>
<p>Como j vimos, para criar um subdiretrio, por nome arquivos_eureka, no diretrio <code>download_arquivos</code>, usamos a funo <code>dir_create</code>, do pacote <strong>fs</strong>. Atribuindo esse passo  varivel <code>arquivos_eureka</code>, temos:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>arquivos_eureka</span> <span class='op'>&lt;-</span> <span class='fu'>fs</span><span class='fu'>::</span><span class='fu'><a href='https://fs.r-lib.org/reference/create.html'>dir_create</a></span><span class='op'>(</span><span class='st'>"downloads/arquivos_eureka"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Estamos quase aptos a realizar o dowload de tudo! Basta, criarmos a lista de argumentos para os parmetros da funo <code>pwalk()</code>:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>eureka_args</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>links_eureka</span>, <span class='va'>arquivos_eureka</span><span class='op'>/</span><span class='va'>nomes_eureka</span>, mode <span class='op'>=</span> <span class='st'>"wb"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Por fim, podemos iterar esse procedimento para todos os arquivos com:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>purrr</span><span class='fu'>::</span><span class='fu'><a href='https://purrr.tidyverse.org/reference/map2.html'>pwalk</a></span><span class='op'>(</span><span class='va'>eureka_args</span>, <span class='va'>download.file</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Voc pode conferir o <em>script</em> completo abaixo:</p>
<details>
<summary>
Script para download de arquivos, em pdf, da Revista Eureka
</summary>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#==============================================================================</span>
<span class='co'># Download das revistas Eureka</span>
<span class='co'># caro Vidal Freire</span>
<span class='co'># data de acesso: 2021-11-26</span>
<span class='co'>#==============================================================================</span>

<span class='co'># url do site -------------------------------------------------------------</span>
<span class='va'>url_eureka</span> <span class='op'>&lt;-</span> <span class='st'>"https://www.obm.org.br/revista-eureka/"</span>

<span class='co'># preparao do site ------------------------------------------------------</span>
<span class='va'>site_eureka</span> <span class='op'>&lt;-</span> <span class='fu'>rvest</span><span class='fu'>::</span><span class='fu'><a href='http://xml2.r-lib.org/reference/read_xml.html'>read_html</a></span><span class='op'>(</span><span class='va'>url_eureka</span><span class='op'>)</span>

<span class='co'># raspagem dos dados ------------------------------------------------------</span>
<span class='co'>## extraindo links</span>
<span class='va'>links_eureka</span> <span class='op'>&lt;-</span> <span class='va'>site_eureka</span> |&gt; 
  <span class='fu'>rvest</span><span class='fu'>::</span><span class='fu'><a href='https://rvest.tidyverse.org/reference/html_element.html'>html_elements</a></span><span class='op'>(</span><span class='st'>"#revistas-list a"</span><span class='op'>)</span> |&gt; 
  <span class='fu'>rvest</span><span class='fu'>::</span><span class='fu'><a href='https://rvest.tidyverse.org/reference/html_attr.html'>html_attr</a></span><span class='op'>(</span><span class='st'>"href"</span><span class='op'>)</span> |&gt; 
  <span class='fu'>stringr</span><span class='fu'>::</span><span class='fu'><a href='https://stringr.tidyverse.org/reference/str_subset.html'>str_subset</a></span><span class='op'>(</span><span class='st'>".pdf"</span><span class='op'>)</span>

<span class='co'>## modificando os nomes</span>
<span class='va'>index</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'>stringr</span><span class='fu'>::</span><span class='fu'><a href='https://stringr.tidyverse.org/reference/str_c.html'>str_c</a></span><span class='op'>(</span><span class='st'>"0"</span>, <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>9</span><span class='op'>)</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>10</span>, <span class='fl'>42</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>nomes_eureka</span> <span class='op'>&lt;-</span> <span class='fu'>stringr</span><span class='fu'>::</span><span class='fu'><a href='https://stringr.tidyverse.org/reference/str_c.html'>str_c</a></span><span class='op'>(</span><span class='va'>index</span>, <span class='st'>"_eureka"</span><span class='op'>)</span>

<span class='co'>## criando os diretrios e caminhos</span>
<span class='va'>arquivos_eureka</span> <span class='op'>&lt;-</span> <span class='fu'>fs</span><span class='fu'>::</span><span class='fu'><a href='https://fs.r-lib.org/reference/create.html'>dir_create</a></span><span class='op'>(</span><span class='st'>"downloads/arquivos_eureka"</span><span class='op'>)</span>

<span class='co'>## preparando os argumentos para download</span>
<span class='va'>eureka_args</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>links_eureka</span>, <span class='va'>arquivos_eureka</span><span class='op'>/</span><span class='va'>nomes_eureka</span>, mode <span class='op'>=</span> <span class='st'>"wb"</span><span class='op'>)</span>

<span class='co'># fazendo os downloads ----------------------------------------------------</span>
<span class='fu'>purrr</span><span class='fu'>::</span><span class='fu'><a href='https://purrr.tidyverse.org/reference/map2.html'>pwalk</a></span><span class='op'>(</span><span class='va'>eureka_args</span>, <span class='va'>download.file</span><span class='op'>)</span>

<span class='co'>#==============================================================================</span>
</code></pre>
</div>
</div>
</details>
<h3 id="raspando-tabelas">5.2.3 Raspando tabelas</h3>
<p>A funo do pacote <strong>rvest</strong> para raspar uma tabela  <code>html_table()</code>.</p>
<p>Para exemplificarmos seu uso, consideremos a seguinte pgina da Wikipdia sobre a linguagem de programao R:</p>
<p align="center">
<a href='https://pt.wikipedia.org/wiki/R_(linguagem_de_programa%C3%A7%C3%A3o)'> https://pt.wikipedia.org/wiki/R_(linguagem_de_programa%C3%A7%C3%A3o) </a>
</p>
<p>Aparentemente, a nica tabela existente na pgina  a da seo Verso.</p>
<p>Diretamente, poderamos fazer:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># url do site -----------------------------------------------------------------</span>
<span class='va'>url_wiki</span> <span class='op'>&lt;-</span> <span class='st'>"https://pt.wikipedia.org/wiki/R_(linguagem_de_programa%C3%A7%C3%A3o)"</span>

<span class='co'># leitura do site -------------------------------------------------------------</span>
<span class='va'>site_wiki</span> <span class='op'>&lt;-</span> <span class='fu'>rvest</span><span class='fu'>::</span><span class='fu'><a href='http://xml2.r-lib.org/reference/read_xml.html'>read_html</a></span><span class='op'>(</span><span class='va'>url_wiki</span><span class='op'>)</span>

<span class='co'># extrao da tabela ----------------------------------------------------------</span>
<span class='va'>tabelas</span> <span class='op'>&lt;-</span> <span class='fu'>rvest</span><span class='fu'>::</span><span class='fu'><a href='https://rvest.tidyverse.org/reference/html_table.html'>html_table</a></span><span class='op'>(</span><span class='va'>site_wiki</span><span class='op'>)</span>

<span class='co'># exibindo o contedo ---------------------------------------------------------</span>
<span class='va'>tabelas</span>
</code></pre>
</div>
<pre><code>[[1]]
# A tibble: 1  2
  X1    X2                                                            
  &lt;lgl&gt; &lt;chr&gt;                                                         
1 NA    As referncias deste artigo necessitam de formatao. Por fav

[[2]]
# A tibble: 1  2
  X1    X2                                                            
  &lt;lgl&gt; &lt;chr&gt;                                                         
1 NA    Este artigo carece de reciclagem de acordo com o  livro de es

[[3]]
# A tibble: 1  2
  X1    X2                                                            
  &lt;lgl&gt; &lt;chr&gt;                                                         
1 NA    Esta pgina cita fontes, mas estas no cobrem todo o contedo

[[4]]
# A tibble: 11  2
   R                   R                                              
   &lt;chr&gt;               &lt;chr&gt;                                          
 1 &quot;&quot;                  &quot;&quot;                                             
 2 &quot;Paradigma&quot;         &quot;multi-paradigma: sequencializao, orientado 
 3 &quot;Surgido em&quot;        &quot;1993[1]&quot;                                      
 4 &quot;ltima verso&quot;     &quot;4.1.0[2](18 de maio de 2021)&quot;                 
 5 &quot;Criado por&quot;        &quot;Ross Ihaka e Robert Gentleman&quot;                
 6 &quot;Estilo de tipagem&quot; &quot;Fraca&quot;                                        
 7 &quot;Dialetos:&quot;         &quot;Microsoft R&quot;                                  
 8 &quot;Influenciada por&quot;  &quot;S, Common Lisp, Scheme, Haskell&quot;              
 9 &quot;Influenciou&quot;       &quot;Julia&quot;                                        
10 &quot;Licena:&quot;          &quot;GPL&quot;                                          
11 &quot;Pgina oficial&quot;    &quot;www.r-project.org&quot;                            

[[5]]
# A tibble: 13  3
   Verso Data         Descrio                                      
   &lt;chr&gt;  &lt;chr&gt;        &lt;chr&gt;                                          
 1 0.16   &quot;&quot;           &quot;Essa foi a ltima verso alpha desenvolvida p
 2 0.49   &quot;1997-04-23&quot; &quot;Esse  o cdigo fonte mais antigo disponvel 
 3 0.60   &quot;1997-12-05&quot; &quot;R se torna parte do Projeto GNU. O cdigo pas
 4 0.65.1 &quot;1999-10-07&quot; &quot;Primeiras verses das funes update.packages
 5 1.0    &quot;2000-02-29&quot; &quot;Considerada pelos desenvolvedores como estve
 6 1.4    &quot;2001-12-19&quot; &quot;Mtodos S4 foram introduzidos e a primeira ve
 7 2.0    &quot;2004-10-04&quot; &quot;Introduzido lazy loading, que permite carrega
 8 2.1    &quot;2005-04-18&quot; &quot;Suporte para UTF-8 e esforos iniciais para l
 9 2.11   &quot;2010-04-22&quot; &quot;Suporte para sistemas Windows de 64 bits.&quot;    
10 2.13   &quot;2011-04-14&quot; &quot;Adicionada uma nova funo ao compilador que 
11 2.14   &quot;2011-10-31&quot; &quot;Adicionados namespaces mandatrios para os pa
12 2.15   &quot;2012-03-30&quot; &quot;Novas funes de balanceamento de carga. Velo
13 3.0    &quot;2013-04-03&quot; &quot;Suporte para indexadores numricos de valor 2

[[6]]
# A tibble: 1  2
  X1                     X2                                           
  &lt;chr&gt;                  &lt;chr&gt;                                        
1 Controle de autoridade &quot;: Q206904\nFramalibre: r\nGND: 4705956-4\nL

[[7]]
# A tibble: 3  2
  `vdeSoftware para anlise numric `vdeSoftware para anlise numri
  &lt;chr&gt;                              &lt;chr&gt;                            
1 &quot;Software livre&quot;                   &quot;Advanced Simulation Library\nAD
2 &quot;Software no-livre&quot;               &quot;DADiSP\nGAUSS\nLabVIEW\nMaple\n
3 &quot;Lista de programas para anlise  &quot;Lista de programas para anlise

[[8]]
# A tibble: 5  3
  `vdeProjeto GNU` `vdeProjeto GNU`                   `vdeProjeto GNU`
  &lt;chr&gt;            &lt;chr&gt;                              &lt;lgl&gt;           
1 Histria         &quot;Manifesto GNU\nFree Software Fou NA              
2 Licenas         &quot;GNU General Public License\nGNU  NA              
3 Software         &quot;GNU (variantes)\nHurd\nLinux-lib NA              
4 Porta-Vozes      &quot;Alexandre Oliva\nBenjamin Mako H NA              
5 Outros assuntos  &quot;Controvrsia quanto  nomenclatu NA              

[[9]]
# A tibble: 3  2
  `vdeLinguagens de programao`     `vdeLinguagens de programao`   
  &lt;chr&gt;                              &lt;chr&gt;                            
1 &quot;Esotricas  Comparao  Hist &quot;Esotricas  Comparao  His
2 &quot;Ada\nAssembly (ASM)\nBASIC\nC\nC &quot;Ada\nAssembly (ASM)\nBASIC\nC\n
3 &quot;Categoria  Lista&quot;               &quot;Categoria  Lista&quot;             </code></pre>
</div>
<p>Para nossa surpresa h 9 tabelas nessa pgina! Quem a escreveu usou do formato da tabela para organizao das informaes, mas em apenas uma colocou elementos caractersticos de um quadro.</p>
<p>Veja que a classe do objeto tabelas  uma lista:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/class.html'>class</a></span><span class='op'>(</span><span class='va'>tabelas</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] &quot;list&quot;</code></pre>
</div>
<p>Ainda analisando essa lista, percebemos que a tabela que desejamos encontra-se na 5 posio. Portanto, podemos selecion-la da seguinte maneira:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>tabela_wiki</span> <span class='op'>&lt;-</span> <span class='va'>tabelas</span><span class='op'>[[</span><span class='fl'>5</span><span class='op'>]</span><span class='op'>]</span>

<span class='va'>tabela_wiki</span>
</code></pre>
</div>
<pre><code># A tibble: 13  3
   Verso Data         Descrio                                      
   &lt;chr&gt;  &lt;chr&gt;        &lt;chr&gt;                                          
 1 0.16   &quot;&quot;           &quot;Essa foi a ltima verso alpha desenvolvida p
 2 0.49   &quot;1997-04-23&quot; &quot;Esse  o cdigo fonte mais antigo disponvel 
 3 0.60   &quot;1997-12-05&quot; &quot;R se torna parte do Projeto GNU. O cdigo pas
 4 0.65.1 &quot;1999-10-07&quot; &quot;Primeiras verses das funes update.packages
 5 1.0    &quot;2000-02-29&quot; &quot;Considerada pelos desenvolvedores como estve
 6 1.4    &quot;2001-12-19&quot; &quot;Mtodos S4 foram introduzidos e a primeira ve
 7 2.0    &quot;2004-10-04&quot; &quot;Introduzido lazy loading, que permite carrega
 8 2.1    &quot;2005-04-18&quot; &quot;Suporte para UTF-8 e esforos iniciais para l
 9 2.11   &quot;2010-04-22&quot; &quot;Suporte para sistemas Windows de 64 bits.&quot;    
10 2.13   &quot;2011-04-14&quot; &quot;Adicionada uma nova funo ao compilador que 
11 2.14   &quot;2011-10-31&quot; &quot;Adicionados namespaces mandatrios para os pa
12 2.15   &quot;2012-03-30&quot; &quot;Novas funes de balanceamento de carga. Velo
13 3.0    &quot;2013-04-03&quot; &quot;Suporte para indexadores numricos de valor 2</code></pre>
</div>
<p>Poderamos simplificar os passos da seguinte forma:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># carregando pacote -----------------------------------------------------------</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://magrittr.tidyverse.org'>magrittr</a></span><span class='op'>)</span>

<span class='co'># url do site -----------------------------------------------------------------</span>
<span class='va'>url_wki</span> <span class='op'>&lt;-</span> <span class='st'>"https://pt.wikipedia.org/wiki/R_(linguagem_de_programa%C3%A7%C3%A3o)"</span>

<span class='co'># lendo e raspando os dados ---------------------------------------------------</span>
<span class='va'>tabela_wiki</span> <span class='op'>&lt;-</span> <span class='va'>url_wki</span> |&gt; 
  <span class='fu'>rvest</span><span class='fu'>::</span><span class='fu'><a href='http://xml2.r-lib.org/reference/read_xml.html'>read_html</a></span><span class='op'>(</span><span class='op'>)</span> |&gt; 
  <span class='fu'>rvest</span><span class='fu'>::</span><span class='fu'><a href='https://rvest.tidyverse.org/reference/html_table.html'>html_table</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='va'>.</span><span class='op'>[[</span><span class='fl'>5</span><span class='op'>]</span><span class='op'>]</span>

<span class='co'># exibindo a tabela -----------------------------------------------------------</span>
<span class='va'>tabela_wiki</span>
</code></pre>
</div>
</div>
<h2 id="construindo-uma-tabela-para-tomada-de-deciso">5.3 Construindo uma tabela para tomada de deciso</h2>
<p>No site da livraria da USP, na seo ASSUNTOS, ao escolhermos Matemtica, somos direcionados para essa pgina:</p>
<p align="center">
<a href='https://www.edusp.com.br/loja/assuntos/21/matematica'> https://www.edusp.com.br/loja/assuntos/21/matematica </a>
</p>
<p>H uma lista de 19 livros (acesso em 23/12/2021), mas suponha que nosso objetivo seja acompanhar a variao do preo de trs deles:</p>
<ul>
<li>Nmeros: Uma Introduo  Matemtica;</li>
<li>Um Poeta, um Matemtico e um Fsico;</li>
<li>Programao Matemtica para Otimizao de Processos.</li>
</ul>
<p>Ainda mais: se o desconto dado pelo site for igual ou superior a 20% do valor do livro, gostaramos que uma tabela fosse exibida com alguma informao direta, como por exemplo, compre; e, caso contrrio, aguarde.</p>
<p>Portanto, precisamos extrair:</p>
<ul>
<li>Os nomes dos livros;</li>
<li>Os preos que esto na categoria De ;</li>
<li>Os preos que esto na categoria Por ;</li>
<li>Uma lista espacfica que desejamos comparar (a nossa lista com os trs livros);</li>
<li>Alguma condio para devolver os termos compre ou aguarde.</li>
</ul>
<p>Vamos fazer isso passo a passo, mas antes de comearmos,  importante organizarmos as coisas:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># url do site -----------------------------------------------------------------</span>
<span class='va'>url_usp</span> <span class='op'>&lt;-</span> <span class='st'>"https://www.edusp.com.br/loja/assuntos/21/matematica"</span>

<span class='co'># lendo o site ----------------------------------------------------------------</span>
<span class='va'>site_usp</span> <span class='op'>&lt;-</span> <span class='va'>url_usp</span> |&gt; 
  <span class='fu'>rvest</span><span class='fu'>::</span><span class='fu'><a href='http://xml2.r-lib.org/reference/read_xml.html'>read_html</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb12"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="ex">Error</span> in open.connection<span class="er">(</span><span class="ex">x,</span> <span class="st">&quot;rb&quot;</span><span class="kw">)</span> <span class="bu">:</span> </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="ex">SSL</span> certificate problem: unable to get local issuer certificate</span></code></pre></div>
</div>
<p>Notem que houve um problema de Certificado de SSL. Vimos que, para contornar isso, retiramos a verificao do certificado (<code>ssl_verifypeer = FALSE</code>) com a funo <code>config()</code>, do pacote <strong>httr</strong>, dentro da funo <code>GET()</code>, do mesmo pacote; sendo tudo isso ANTES do <code>read_html()</code>:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># url do site -----------------------------------------------------------------</span>
<span class='va'>url_usp</span> <span class='op'>&lt;-</span> <span class='st'>"https://www.edusp.com.br/loja/assuntos/21/matematica"</span>

<span class='co'># lendo o site ----------------------------------------------------------------</span>
<span class='va'>site_usp</span> <span class='op'>&lt;-</span> <span class='va'>url_usp</span> |&gt; 
  <span class='fu'>httr</span><span class='fu'>::</span><span class='fu'><a href='https://httr.r-lib.org/reference/GET.html'>GET</a></span><span class='op'>(</span><span class='fu'>httr</span><span class='fu'>::</span><span class='fu'><a href='https://httr.r-lib.org/reference/config.html'>config</a></span><span class='op'>(</span>ssl_verifypeer <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span><span class='op'>)</span> |&gt; 
  <span class='fu'>rvest</span><span class='fu'>::</span><span class='fu'><a href='http://xml2.r-lib.org/reference/read_xml.html'>read_html</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h3 id="extraindo-os-nomes-dos-livros">5.3.1 Extraindo os nomes dos livros</h3>
<p>Utilizando o SelectorGadget, clicamos sobre um dos ttulos do livro e fazemos os ajustes necessrios (aparecero elementos no rodap da pgina do site que no so convenientes). Com isso, um possvel CSS : #dvProdutos p.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>site_usp</span> |&gt; 
  <span class='fu'>rvest</span><span class='fu'>::</span><span class='fu'><a href='https://rvest.tidyverse.org/reference/html_element.html'>html_elements</a></span><span class='op'>(</span><span class='st'>"#dvProdutos p"</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>{xml_nodeset (19)}
 [1] &lt;p&gt;\r\n                                    Amostragem Probabil ...
 [2] &lt;p&gt;\r\n                                    Bioestatstica em O ...
 [3] &lt;p&gt;\r\n                                    Clculo em uma Vari ...
 [4] &lt;p&gt;\r\n                                    Clculo Integral Av ...
 [5] &lt;p&gt;\r\n                                    Curso de lgebra Li ...
 [6] &lt;p&gt;\r\n                                    tica em Computao ...
 [7] &lt;p&gt;\r\n                                    Introduo  Fsica ...
 [8] &lt;p&gt;\r\n                                    Introduo  Mecni ...
 [9] &lt;p&gt;\r\n                                    Lgica Matemtica&lt;/p&gt;
[10] &lt;p&gt;\r\n                                    Noes de Probabili ...
[11] &lt;p&gt;\r\n                                    Nmeros: Uma Introd ...
[12] &lt;p&gt;\r\n                                    Ondas e Ondaletas:  ...
[13] &lt;p&gt;\r\n                                    Poeta, um Matemtic ...
[14] &lt;p&gt;\r\n                                    Probabilidade e Var ...
[15] &lt;p&gt;\r\n                                    Probabilidade: Um C ...
[16] &lt;p&gt;\r\n                                    Programao Matemt ...
[17] &lt;p&gt;\r\n                                    Tcnicas Computacio ...
[18] &lt;p&gt;\r\n                                    Topologia Geomtric ...
[19] &lt;p&gt;\r\n                                    Uma Varivel Comple ...</code></pre>
</div>
<p>Queremos extrair os nomes dos livros. Logo, interessa-nos o texto entre a tag <code>&lt;p&gt;</code>; e, para isso, usamos a funo <code>text2()</code>:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>site_usp</span> |&gt; 
  <span class='fu'>rvest</span><span class='fu'>::</span><span class='fu'><a href='https://rvest.tidyverse.org/reference/html_element.html'>html_elements</a></span><span class='op'>(</span><span class='st'>"#dvProdutos p"</span><span class='op'>)</span> |&gt; 
  <span class='fu'>rvest</span><span class='fu'>::</span><span class='fu'><a href='https://rvest.tidyverse.org/reference/html_text.html'>html_text2</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code> [1] &quot;\r Amostragem Probabilstica: Um Curso...&quot;   
 [2] &quot;\r Bioestatstica em Outras Palavras&quot;        
 [3] &quot;\r Clculo em uma Varivel Real&quot;             
 [4] &quot;\r Clculo Integral Avanado&quot;                
 [5] &quot;\r Curso de lgebra Linear, Um&quot;              
 [6] &quot;\r tica em Computao&quot;                      
 [7] &quot;\r Introduo  Fsica Estatstica&quot;          
 [8] &quot;\r Introduo  Mecnica Clssica&quot;           
 [9] &quot;\r Lgica Matemtica&quot;                        
[10] &quot;\r Noes de Probabilidade e Estatstica&quot;    
[11] &quot;\r Nmeros: Uma Introduo  Matemtica&quot;     
[12] &quot;\r Ondas e Ondaletas: Da Anlise de...&quot;      
[13] &quot;\r Poeta, um Matemtico e um Fsico, Um:...&quot; 
[14] &quot;\r Probabilidade e Variveis Aleatrias&quot;     
[15] &quot;\r Probabilidade: Um Curso Introdutrio&quot;     
[16] &quot;\r Programao Matemtica para Otimizao...&quot;
[17] &quot;\r Tcnicas Computacionais para Dinmica...&quot; 
[18] &quot;\r Topologia Geomtrica para Inquietos&quot;      
[19] &quot;\r Uma Varivel Complexa: Teoria e...&quot;       </code></pre>
</div>
<p>E, para retirar os caracteres indesejados de espaamento, usamos a funo <code>str_trim()</code>, do pacote <strong>stringr</strong>:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>site_usp</span> |&gt; 
  <span class='fu'>rvest</span><span class='fu'>::</span><span class='fu'><a href='https://rvest.tidyverse.org/reference/html_element.html'>html_elements</a></span><span class='op'>(</span><span class='st'>"#dvProdutos p"</span><span class='op'>)</span> |&gt; 
  <span class='fu'>rvest</span><span class='fu'>::</span><span class='fu'><a href='https://rvest.tidyverse.org/reference/html_text.html'>html_text2</a></span><span class='op'>(</span><span class='op'>)</span> |&gt; 
  <span class='fu'>stringr</span><span class='fu'>::</span><span class='fu'><a href='https://stringr.tidyverse.org/reference/str_trim.html'>str_trim</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code> [1] &quot;Amostragem Probabilstica: Um Curso...&quot;   
 [2] &quot;Bioestatstica em Outras Palavras&quot;        
 [3] &quot;Clculo em uma Varivel Real&quot;             
 [4] &quot;Clculo Integral Avanado&quot;                
 [5] &quot;Curso de lgebra Linear, Um&quot;              
 [6] &quot;tica em Computao&quot;                      
 [7] &quot;Introduo  Fsica Estatstica&quot;          
 [8] &quot;Introduo  Mecnica Clssica&quot;           
 [9] &quot;Lgica Matemtica&quot;                        
[10] &quot;Noes de Probabilidade e Estatstica&quot;    
[11] &quot;Nmeros: Uma Introduo  Matemtica&quot;     
[12] &quot;Ondas e Ondaletas: Da Anlise de...&quot;      
[13] &quot;Poeta, um Matemtico e um Fsico, Um:...&quot; 
[14] &quot;Probabilidade e Variveis Aleatrias&quot;     
[15] &quot;Probabilidade: Um Curso Introdutrio&quot;     
[16] &quot;Programao Matemtica para Otimizao...&quot;
[17] &quot;Tcnicas Computacionais para Dinmica...&quot; 
[18] &quot;Topologia Geomtrica para Inquietos&quot;      
[19] &quot;Uma Varivel Complexa: Teoria e...&quot;       </code></pre>
</div>
<p>Vamos salvar tudoo isso na varivel <code>nomes_livros</code>:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>nomes_livros</span> <span class='op'>&lt;-</span> <span class='va'>site_usp</span> |&gt; 
  <span class='fu'>rvest</span><span class='fu'>::</span><span class='fu'><a href='https://rvest.tidyverse.org/reference/html_element.html'>html_elements</a></span><span class='op'>(</span><span class='st'>"#dvProdutos p"</span><span class='op'>)</span> |&gt; 
  <span class='fu'>rvest</span><span class='fu'>::</span><span class='fu'><a href='https://rvest.tidyverse.org/reference/html_text.html'>html_text2</a></span><span class='op'>(</span><span class='op'>)</span> |&gt; 
  <span class='fu'>stringr</span><span class='fu'>::</span><span class='fu'><a href='https://stringr.tidyverse.org/reference/str_trim.html'>str_trim</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h3 id="extraindo-os-preos">5.3.2 Extraindo os preos</h3>
<p>Para extrao dos preos, lembremos que so duas categorias:</p>
<ul>
<li>De ; que substituiremos por <code>preco_antigo</code>.</li>
<li>Por ; que substituiremos por <code>preco_desconto</code>.</li>
</ul>
<h4 id="preo-antigo">5.3.2.1 Preo antigo</h4>
<p>Utilizando o SelectorGadget, ao clicarmos na regio onde h um trao no preo, encontramos o seguinte elemento CSS: strike.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>site_usp</span> |&gt; 
  <span class='fu'>rvest</span><span class='fu'>::</span><span class='fu'><a href='https://rvest.tidyverse.org/reference/html_element.html'>html_elements</a></span><span class='op'>(</span><span class='st'>"strike"</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>{xml_nodeset (19)}
 [1] &lt;strike&gt;R$ 40,00&lt;/strike&gt;
 [2] &lt;strike&gt;R$ 66,00&lt;/strike&gt;
 [3] &lt;strike&gt;R$ 74,00&lt;/strike&gt;
 [4] &lt;strike&gt;R$ 52,00&lt;/strike&gt;
 [5] &lt;strike&gt;R$ 45,00&lt;/strike&gt;
 [6] &lt;strike&gt;R$ 40,00&lt;/strike&gt;
 [7] &lt;strike&gt;R$ 80,00&lt;/strike&gt;
 [8] &lt;strike&gt;R$ 78,00&lt;/strike&gt;
 [9] &lt;strike&gt;R$ 34,00&lt;/strike&gt;
[10] &lt;strike&gt;R$ 52,00&lt;/strike&gt;
[11] &lt;strike&gt;R$ 42,00&lt;/strike&gt;
[12] &lt;strike&gt;R$ 44,00&lt;/strike&gt;
[13] &lt;strike&gt;R$ 30,00&lt;/strike&gt;
[14] &lt;strike&gt;R$ 50,00&lt;/strike&gt;
[15] &lt;strike&gt;R$ 52,00&lt;/strike&gt;
[16] &lt;strike&gt;R$ 44,00&lt;/strike&gt;
[17] &lt;strike&gt;R$ 74,00&lt;/strike&gt;
[18] &lt;strike&gt;R$ 36,00&lt;/strike&gt;
[19] &lt;strike&gt;R$ 38,00&lt;/strike&gt;</code></pre>
</div>
<p>Retirando o texto dessa <em>tag</em>, temos:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>site_usp</span> |&gt; 
  <span class='fu'>rvest</span><span class='fu'>::</span><span class='fu'><a href='https://rvest.tidyverse.org/reference/html_element.html'>html_elements</a></span><span class='op'>(</span><span class='st'>"strike"</span><span class='op'>)</span> |&gt; 
  <span class='fu'>rvest</span><span class='fu'>::</span><span class='fu'><a href='https://rvest.tidyverse.org/reference/html_text.html'>html_text2</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code> [1] &quot;R$ 40,00&quot; &quot;R$ 66,00&quot; &quot;R$ 74,00&quot; &quot;R$ 52,00&quot; &quot;R$ 45,00&quot; &quot;R$ 40,00&quot;
 [7] &quot;R$ 80,00&quot; &quot;R$ 78,00&quot; &quot;R$ 34,00&quot; &quot;R$ 52,00&quot; &quot;R$ 42,00&quot; &quot;R$ 44,00&quot;
[13] &quot;R$ 30,00&quot; &quot;R$ 50,00&quot; &quot;R$ 52,00&quot; &quot;R$ 44,00&quot; &quot;R$ 74,00&quot; &quot;R$ 36,00&quot;
[19] &quot;R$ 38,00&quot;</code></pre>
</div>
<p>Obviamente, queremos apenas os valores numricos, visto que ainda vamos operar com os mesmos para criarmos condies para tomada de deciso. Assim, observando o padro, interessa-nos os elementos depois do 3 caractere, ou seja, a partir do 4 caractere. A funo <code>str_sub()</code>, do pacote <strong>stringr</strong> faz isso perfeitamente:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>site_usp</span> |&gt; 
  <span class='fu'>rvest</span><span class='fu'>::</span><span class='fu'><a href='https://rvest.tidyverse.org/reference/html_element.html'>html_elements</a></span><span class='op'>(</span><span class='st'>"strike"</span><span class='op'>)</span> |&gt; 
  <span class='fu'>rvest</span><span class='fu'>::</span><span class='fu'><a href='https://rvest.tidyverse.org/reference/html_text.html'>html_text2</a></span><span class='op'>(</span><span class='op'>)</span> |&gt; 
  <span class='fu'>stringr</span><span class='fu'>::</span><span class='fu'><a href='https://stringr.tidyverse.org/reference/str_sub.html'>str_sub</a></span><span class='op'>(</span><span class='fl'>4</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code> [1] &quot;40,00&quot; &quot;66,00&quot; &quot;74,00&quot; &quot;52,00&quot; &quot;45,00&quot; &quot;40,00&quot; &quot;80,00&quot; &quot;78,00&quot;
 [9] &quot;34,00&quot; &quot;52,00&quot; &quot;42,00&quot; &quot;44,00&quot; &quot;30,00&quot; &quot;50,00&quot; &quot;52,00&quot; &quot;44,00&quot;
[17] &quot;74,00&quot; &quot;36,00&quot; &quot;38,00&quot;</code></pre>
</div>
<p>Agora, sabemos que o R identifica o ponto como separador decimal. Logo, devemos substituir a vrgula pelo ponto. Para isso, usamo a funo <code>str_replace_all()</code>:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>site_usp</span> |&gt; 
  <span class='fu'>rvest</span><span class='fu'>::</span><span class='fu'><a href='https://rvest.tidyverse.org/reference/html_element.html'>html_elements</a></span><span class='op'>(</span><span class='st'>"strike"</span><span class='op'>)</span> |&gt; 
  <span class='fu'>rvest</span><span class='fu'>::</span><span class='fu'><a href='https://rvest.tidyverse.org/reference/html_text.html'>html_text2</a></span><span class='op'>(</span><span class='op'>)</span> |&gt; 
  <span class='fu'>stringr</span><span class='fu'>::</span><span class='fu'><a href='https://stringr.tidyverse.org/reference/str_sub.html'>str_sub</a></span><span class='op'>(</span><span class='fl'>4</span><span class='op'>)</span> |&gt; 
  <span class='fu'>stringr</span><span class='fu'>::</span><span class='fu'><a href='https://stringr.tidyverse.org/reference/str_replace.html'>str_replace_all</a></span><span class='op'>(</span><span class='st'>","</span>, <span class='st'>"."</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code> [1] &quot;40.00&quot; &quot;66.00&quot; &quot;74.00&quot; &quot;52.00&quot; &quot;45.00&quot; &quot;40.00&quot; &quot;80.00&quot; &quot;78.00&quot;
 [9] &quot;34.00&quot; &quot;52.00&quot; &quot;42.00&quot; &quot;44.00&quot; &quot;30.00&quot; &quot;50.00&quot; &quot;52.00&quot; &quot;44.00&quot;
[17] &quot;74.00&quot; &quot;36.00&quot; &quot;38.00&quot;</code></pre>
</div>
<p>Mas, ainda temos um conjundo de caracteres (<em>character</em>) e no nmeros (<em>numeric</em>). Para extrairmos apenas os nmeros, podemos usar a funo <code>parse_double()</code>, do pacote <strong>readr</strong>:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>site_usp</span> |&gt; 
  <span class='fu'>rvest</span><span class='fu'>::</span><span class='fu'><a href='https://rvest.tidyverse.org/reference/html_element.html'>html_elements</a></span><span class='op'>(</span><span class='st'>"strike"</span><span class='op'>)</span> |&gt; 
  <span class='fu'>rvest</span><span class='fu'>::</span><span class='fu'><a href='https://rvest.tidyverse.org/reference/html_text.html'>html_text2</a></span><span class='op'>(</span><span class='op'>)</span> |&gt; 
  <span class='fu'>stringr</span><span class='fu'>::</span><span class='fu'><a href='https://stringr.tidyverse.org/reference/str_sub.html'>str_sub</a></span><span class='op'>(</span><span class='fl'>4</span><span class='op'>)</span> |&gt; 
  <span class='fu'>stringr</span><span class='fu'>::</span><span class='fu'><a href='https://stringr.tidyverse.org/reference/str_replace.html'>str_replace_all</a></span><span class='op'>(</span><span class='st'>","</span>, <span class='st'>"."</span><span class='op'>)</span> |&gt; 
  <span class='fu'>readr</span><span class='fu'>::</span><span class='fu'><a href='https://readr.tidyverse.org/reference/parse_atomic.html'>parse_double</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code> [1] 40 66 74 52 45 40 80 78 34 52 42 44 30 50 52 44 74 36 38</code></pre>
</div>
<p>Vamos atribuir  varivel <code>preco_antigo</code> esses cdigos:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>preco_antigo</span> <span class='op'>&lt;-</span> <span class='va'>site_usp</span> |&gt; 
  <span class='fu'>rvest</span><span class='fu'>::</span><span class='fu'><a href='https://rvest.tidyverse.org/reference/html_element.html'>html_elements</a></span><span class='op'>(</span><span class='st'>"strike"</span><span class='op'>)</span> |&gt; 
  <span class='fu'>rvest</span><span class='fu'>::</span><span class='fu'><a href='https://rvest.tidyverse.org/reference/html_text.html'>html_text2</a></span><span class='op'>(</span><span class='op'>)</span> |&gt; 
  <span class='fu'>stringr</span><span class='fu'>::</span><span class='fu'><a href='https://stringr.tidyverse.org/reference/str_sub.html'>str_sub</a></span><span class='op'>(</span><span class='fl'>4</span><span class='op'>)</span> |&gt; 
  <span class='fu'>stringr</span><span class='fu'>::</span><span class='fu'><a href='https://stringr.tidyverse.org/reference/str_replace.html'>str_replace_all</a></span><span class='op'>(</span><span class='st'>","</span>, <span class='st'>"."</span><span class='op'>)</span> |&gt; 
  <span class='fu'>readr</span><span class='fu'>::</span><span class='fu'><a href='https://readr.tidyverse.org/reference/parse_atomic.html'>parse_double</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h4 id="preo-antigo-1">5.3.2.2 Preo antigo</h4>
<p>Procedendo de forma anloga, podemos extrair o <code>preco_desconto</code>:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>preco_desconto</span> <span class='op'>&lt;-</span> <span class='va'>site_usp</span> |&gt; 
  <span class='fu'>rvest</span><span class='fu'>::</span><span class='fu'><a href='https://rvest.tidyverse.org/reference/html_element.html'>html_elements</a></span><span class='op'>(</span><span class='st'>"h2+ h2"</span><span class='op'>)</span> |&gt;     <span class='co'># elemento CSS</span>
  <span class='fu'>rvest</span><span class='fu'>::</span><span class='fu'><a href='https://rvest.tidyverse.org/reference/html_text.html'>html_text2</a></span><span class='op'>(</span><span class='op'>)</span> |&gt;                <span class='co'># extrao do contedo (texto)</span>
  <span class='fu'>stringr</span><span class='fu'>::</span><span class='fu'><a href='https://stringr.tidyverse.org/reference/str_trim.html'>str_trim</a></span><span class='op'>(</span><span class='op'>)</span> |&gt;                <span class='co'># eliminando espaos indesejveis</span>
  <span class='fu'>stringr</span><span class='fu'>::</span><span class='fu'><a href='https://stringr.tidyverse.org/reference/str_sub.html'>str_sub</a></span><span class='op'>(</span><span class='fl'>8</span><span class='op'>)</span> |&gt;                <span class='co'># extraindo a partir do 8 caractere</span>
  <span class='fu'>stringr</span><span class='fu'>::</span><span class='fu'><a href='https://stringr.tidyverse.org/reference/str_replace.html'>str_replace</a></span><span class='op'>(</span><span class='st'>","</span>, <span class='st'>"."</span><span class='op'>)</span> |&gt;     <span class='co'># substituindo 'virgula' por 'ponto'</span>
  <span class='fu'>readr</span><span class='fu'>::</span><span class='fu'><a href='https://readr.tidyverse.org/reference/parse_atomic.html'>parse_double</a></span><span class='op'>(</span><span class='op'>)</span>                 <span class='co'># transformando 'character' para 'numeric'</span>
</code></pre>
</div>
</div>
<h3 id="construindo-a-tabela">5.3.2 Construindo a tabela</h3>
<h2 id="raspagem-com-vrias-pginas">5.4 Raspagem com vrias pginas</h2>
<div class="sourceCode" id="cb21"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom"></div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
